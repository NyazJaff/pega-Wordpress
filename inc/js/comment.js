(window.webpackJsonp=window.webpackJsonp||[]).push([["desktop/comment"],{sKSS:function(e,t){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var c,m=e[Symbol.iterator]();!(o=(c=m.next()).done)&&(n.push(c.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==m.return||m.return()}finally{if(a)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(){grecaptcha.execute().then(function(e){document.getElementById("comment-token").value=e,function(){var e=document.getElementById("comment-errors");e.innerHTML="";var t=JSON.stringify({entry:commentEntry,title:document.getElementById("comment-subject").value,comment:document.getElementById("comment-text").value,name:document.getElementById("comment-name").value,email:document.getElementById("comment-email").value,token:document.getElementById("comment-token").value});(function(e,t){return new Promise(function(n,o){var a=new XMLHttpRequest;a.onload=function(){n(this)},a.onerror=function(){o(this)},a.open("post",e),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(t)})})(apiUrl+"api/comments",t).then(function(t){if(t.status<300)console.log("success"),document.getElementById("add-comment-form").style.display="none",document.getElementById("comment-sent").style.display="block";else{console.log("error");var o=JSON.parse(t.response),a=document.createElement("ul"),r=document.createElement("li");if("invalid_recaptcha"===o.error||"invalid_token"===o.error?r.innerHTML="حدث خطأ الرجاء اعادة المحاولة":r.innerHTML=o.error,a.appendChild(r),null!==o.messages&&void 0!==o.messages)for(var c=0,m=Object.entries(o.messages);c<m.length;c++){var i=n(m[c],2),s=i[0],l=i[1],u=document.createElement("li");u.innerHTML=s+": "+l,a.appendChild(u)}e.appendChild(a)}}).catch(function(e){console.log("catch"),console.log(e)})}()})}document.getElementById("comment-form").addEventListener("submit",function(e){e.preventDefault(),o()}),commentsTotal>5&&function(){var e=document.getElementById("show-all-comments");e.addEventListener("click",function(t){t.preventDefault();var n=document.getElementsByClassName("comment");Array.prototype.forEach.call(n,function(e){e.style.display="block"}),e.style.display="none",document.getElementById("comment-pagination").style.display="block"});for(var t=document.getElementsByClassName("pagination-link"),n=document.getElementById("pagination-next"),o=document.getElementById("pagination-previous"),a=function(e){(function(e,t){return new Promise(function(n,o){var a=new XMLHttpRequest;a.onload=function(){n(this)},a.onerror=function(){o(this)};var r=new URL(apiUrl+"api/comments");r.searchParams.set("entry",e),r.searchParams.set("page",t),a.open("get",r),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send()})})(commentEntry,e).then(function(a){if(a.status<300){console.log("success");for(var r=JSON.parse(a.responseText),c=document.getElementById("comments-container");c.hasChildNodes();)c.removeChild(c.firstChild);for(var m=0;m<r.comments.length;m++){var i=document.createElement("div");i.className="comment";var s=document.createElement("h4");if(s.innerHTML=r.comments[m].title,null!==r.comments[m].name&&""!==r.comments[m].name){var l=document.createElement("p");l.innerHTML=r.comments[m].name,s.appendChild(l)}var u=document.createElement("p"),d=new Date(r.comments[m].createdAt);u.innerHTML=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+" "+d.getHours()+":"+(d.getMinutes()+1)+":"+d.getSeconds();var p=document.createAttribute("dir");p.value="auto",u.setAttributeNode(p),u.className="date";var g=document.createElement("div");g.innerHTML=r.comments[m].comment,i.appendChild(s),i.appendChild(u),i.appendChild(g),c.appendChild(i)}document.getElementById("comments").scrollIntoView(!0);for(var f=0;f<t.length;f++)t[f].classList.remove("active"),t[f].getAttribute("page")==e&&t[f].classList.add("active");e>1&&o.setAttribute("page",parseInt(e)-1),r.commentsMeta.lastPage>e&&n.setAttribute("page",parseInt(e)+1)}else console.log("error")}).catch(function(e){console.log("catch"),console.log(e)})},r=function(e){t[e].addEventListener("click",function(n){n.preventDefault(),a(t[e].getAttribute("page"))},!1)},c=0;c<t.length;c++)r(c);n.addEventListener("click",function(e){e.preventDefault(),a(n.getAttribute("page"))},!1),o.addEventListener("click",function(e){e.preventDefault(),a(o.getAttribute("page"))},!1)}()}},[["sKSS","runtime"]]]);